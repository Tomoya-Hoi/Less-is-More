<!DOCTYPE html>

<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="../lib/jquery.min.js"></script>
    <script type="text/javascript" src="../lib/osql.js"></script>

    <script>
      osql.requireLogin();

      function registerButtonPressed() {
        main();
      }

      function main() {
        console.log("function main()");
        const personalData = getPersonalData();
        const sql = makeSQL(personalData);
        const result = executeInsert(sql);
      }

      function getPersonalData() {
        console.log("getPersonalData()");

        const password = document.getElementById('passwordForm').value;
        const username = document.getElementById('usernameForm').value;
        const object = {password, username};

        return object;
      }

      function validateData(){
        console.log("function validateData()");

        
      }

      function makeSQL(object) {
        console.log("function makeSQL()");
        const sql = `insert into users (password, username) values("${object.password}", "${object.username}");`;

        console.log("sql =", sql);

        return sql;
      }

      async function executeInsert(sql) {
        console.log("function executeInsert()");

        const result = await osql.connect(sql);
        console.log(result);

        return result;
      }
      

      // async function execInsert(){
      //   //var userid   = document.getElementById('useridForm').value;
      //   var password = document.getElementById('passwordForm').value;
      //   var username = document.getElementById('usernameForm').value;

      //   var sql = `insert into users (password, username) values("${password}", "${username}");`;
      //   var objects = await osql.connect(sql)
      //   console.log(objects);
      //   document.getElementById('result').innerHTML = 'OK';
      // }
    </script>
  </head>

  <body>
    <h1>Less is More</h1>
    <h2>Registration</h2>

    password:<input id="passwordForm" value="testpass" type="password"><br>
    username:<input id="usernameForm" value="testuser" type="textfield"><br>
    <button onclick="registerButtonPressed()">Register</button>
    <br>
    <p id="result"></p>
  </body>
</html>